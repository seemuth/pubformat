<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Citation List Converter</title>
<style type="text/css" media="all">
body { background-color: whitesmoke; text-align: center; }
div.main { margin-left: auto; margin-right: auto; max-width: 1000px; background-color: white; }
div.label { font-weight: bold; }
div.data { margin-bottom: 2em; }
textarea { margin-left: auto; margin-right: auto; }
p.version { font-size: 75%; color: grey; }
</style>
<body>
<div class="main">
    <div class="data">
        <div class="label">Citation data input</div>
        <div class="databox">
            <textarea id="datain" rows="20" cols="90" onchange="datainchange(this)" onkeyup="datainchange(this)" onfocus="this.select()"></textarea>
        </div>
    </div>
    <div class="data">
        <div class="label">Post output</div>
        <div class="databox">
            <textarea id="dataout" rows="20" cols="90" onfocus="this.select()"></textarea>
        </div>
    </div>
</div>
<script>
function valuefilter(b){var a=[[/---/g,"&mdash;"],[/--/g,"&ndash;"]];for(var e=0;e<a.length;e++){var d=a[e][0];var c=a[e][1];b=b.replace(d,c)}return b}function importbib(e){var f=[];var a={};var h=e.split("\n");for(var c=0;c<h.length;c++){var j=h[c].trim();var d=j.indexOf("=");if((d<0)&&(j.indexOf("}")>=0)){f.push(a);a={}}else{if(d>0){var b=j.substr(0,d);var g=valuefilter(j.substr(d+1));a[b]=g}}}return f}function pubsortcompare(d,c){if(d.year>c.year){return -1}else{if(d.year==c.year){if(d.title<c.title){return -1}else{if(d.title==c.title){return 0}else{return 1}}}else{return 1}}};function datainchange(g){var f=document.getElementById("dataout");var e=importbib(g.value);e.sort(pubsortcompare);f.value="";for(var b=0;b<e.length;b++){var c=e[b];var d=[];for(var a in c){d.push(a+"="+c[a])}f.value+=d.join(" ")+"\n\n"}f.value=f.value.trim()};</script>
<p class="version">Version v0.0.1</p>
</body>
</html>
