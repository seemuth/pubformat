<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Citation List Converter</title>
<style type="text/css" media="all">
body { background-color: whitesmoke; text-align: center; }
div.main { margin-left: auto; margin-right: auto; max-width: 1000px; background-color: white; }
div.label { font-weight: bold; }
div.data { margin-top: 1em; margin-bottom: 1em; }
textarea { margin-left: auto; margin-right: auto; }
p.version { font-size: 75%; color: grey; }
</style>
<body>
<div class="main">
    <div class="data">
        <div class="label">Citation data input</div>
        <div class="databox">
            <textarea id="datain" rows="20" cols="90" onchange="datainchange(this)" onkeyup="datainchange(this)" onfocus="this.select()"></textarea>
        </div>
    </div>
    <div class="status"><span id="status"></span></div>
    <div class="data">
        <div class="label">Post output</div>
        <div class="databox">
            <textarea id="dataout" rows="20" cols="90" onfocus="this.select()"></textarea>
        </div>
    </div>
</div>
<script>
function valuefilter(b){var a=[[/---/g,"&mdash;"],[/--/g,"&ndash;"]];var g=b.indexOf("{");var f=b.indexOf("}");if((g>=0)&&(f>g)){b=b.substring(g+1,f)}for(var e=0;e<a.length;e++){var d=a[e][0];var c=a[e][1];b=b.replace(d,c)}return b}function importbib(e){var f=[];var a={};var h=e.split("\n");for(var c=0;c<h.length;c++){var j=h[c].trim();var d=j.indexOf("=");if((d<0)&&(j.indexOf("}")>=0)){f.push(a);a={}}else{if(d>0){var b=j.substr(0,d);var g=valuefilter(j.substr(d+1));a[b]=g}}}return f}function pubsortcompare(d,c){if(d.year==c.year){if(d.title<c.title){return -1}else{if(d.title==c.title){return 0}else{return 1}}}else{if(d.year==undefined){return 1}else{if(c.year==undefined){return -1}else{if(d.year>c.year){return -1}else{return 1}}}}};function splitauthors(b){var a=b.split(" and ");return a.join("; ")}function pubtopost(a){var b=[];var c=undefined;if((c==undefined)&&(a.booktitle!=undefined)){c=a.booktitle}else{if((c==undefined)&&(a.journal!=undefined)){c=a.journal}}b.push(splitauthors(a.author));b.push("<strong>"+a.title+"</strong>");if(c!=undefined){b.push("<em>"+c+"</em>")}if(a.year!=undefined){b.push("("+a.year+")")}return b.join(". ")}function exportpost(c){var a=[];a.push('<ul class="publications">');for(var b=0;b<c.length;b++){a.push("<li>"+pubtopost(c[b])+"</li>")}a.push("</ul>");return a.join("\n")};var statusstate=0;var statusinterval=null;function updatestatusdisplay(){var a=document.getElementById("status");statusstate--;if(statusstate<0){a.innerHTML="";window.clearInterval(statusinterval);statusinterval=null;return}if(statusstate>=25){var b=255-(10*(statusstate-25));if(b>255){b=255}else{if(b<0){b=0}}a.style["background-color"]=("rgb("+b.toString()+",255,"+b.toString()+")")}else{var b=255-(10*statusstate);if(b<0){b=0}a.style.color=("rgb("+b.toString()+","+b.toString()+","+b.toString()+")")}}function setstatus(b){var a=document.getElementById("status");a.innerHTML=b;a.style.color="rgb(0,0,0)";a.style["background-color"]="rgb(0,255,0)";statusstate=50;if(statusinterval==null){statusinterval=window.setInterval(updatestatusdisplay,100)}}function datainchange(c){var b=document.getElementById("dataout");var a=importbib(c.value);b.value="";a.sort(pubsortcompare);b.value=exportpost(a);if(b.value.length>0){setstatus("Generated post content.")}else{setstatus("Error generating post content!")}};</script>
<p class="version">Version v0.2.0</p>
</body>
</html>
